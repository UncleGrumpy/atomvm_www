<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libAtomVM: /home/runner/work/AtomVM/AtomVM/src/libAtomVM/refc_binary.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="AVM-alt.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libAtomVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_71a31c0df5161b11b9c2da40f7f3343f.html">libAtomVM</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">refc_binary.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="context_8h_source.html">context.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="refc__binary_8h_source.html">refc_binary.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dictionary_8h_source.html">dictionary.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memory_8h_source.html">memory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tempstack_8h_source.html">tempstack.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for refc_binary.c:</div>
<div class="dyncontent">
<div class="center"><img src="refc__binary_8c__incl.png" border="0" usemap="#a_2home_2runner_2work_2_atom_v_m_2_atom_v_m_2src_2lib_atom_v_m_2refc__binary_8c" alt=""/></div>
<map name="a_2home_2runner_2work_2_atom_v_m_2_atom_v_m_2src_2lib_atom_v_m_2refc__binary_8c" id="a_2home_2runner_2work_2_atom_v_m_2_atom_v_m_2src_2lib_atom_v_m_2refc__binary_8c">
<area shape="rect" title=" " alt="" coords="905,5,1116,61"/>
<area shape="rect" title=" " alt="" coords="581,557,651,584"/>
<area shape="rect" href="context_8h.html" title="Context struct and related management functions." alt="" coords="612,109,695,136"/>
<area shape="rect" href="memory_8h.html" title=" " alt="" coords="803,333,890,360"/>
<area shape="rect" href="refc__binary_8h.html" title=" " alt="" coords="145,333,250,360"/>
<area shape="rect" href="dictionary_8h.html" title=" " alt="" coords="407,184,505,211"/>
<area shape="rect" href="tempstack_8h.html" title=" " alt="" coords="966,333,1069,360"/>
<area shape="rect" href="trace_8h.html" title=" " alt="" coords="1245,109,1312,136"/>
<area shape="rect" href="globalcontext_8h.html" title="GlobalContext struct and related management functions." alt="" coords="691,184,813,211"/>
<area shape="rect" href="linkedlist_8h.html" title="Linked list manipulation functions." alt="" coords="88,483,181,509"/>
<area shape="rect" href="term_8h.html" title="term manipulation functions" alt="" coords="631,259,697,285"/>
<area shape="rect" href="timer__wheel_8h.html" title=" " alt="" coords="275,333,389,360"/>
<area shape="rect" title=" " alt="" coords="859,483,930,509"/>
<area shape="rect" href="atom_8h.html" title="Atoms manipulation functions." alt="" coords="1102,408,1170,435"/>
<area shape="rect" title=" " alt="" coords="291,408,373,435"/>
<area shape="rect" title=" " alt="" coords="464,333,531,360"/>
<area shape="rect" title=" " alt="" coords="555,333,626,360"/>
<area shape="rect" href="term__typedef_8h.html" title="term type definition" alt="" coords="654,408,775,435"/>
<area shape="rect" href="utils_8h.html" title="Misc functions and macros." alt="" coords="902,408,965,435"/>
<area shape="rect" title=" " alt="" coords="765,483,835,509"/>
<area shape="rect" title=" " alt="" coords="654,483,741,509"/>
<area shape="rect" href="list_8h.html" title=" " alt="" coords="149,408,203,435"/>
</map>
</div>
</div>
<p><a href="refc__binary_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a658404899be2339778266056eb36da07"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#a658404899be2339778266056eb36da07">refc_binary_create_refc</a> (size_t size)</td></tr>
<tr class="memdesc:a658404899be2339778266056eb36da07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a reference-counted binary outside of the process heap.  <a href="refc__binary_8c.html#a658404899be2339778266056eb36da07">More...</a><br /></td></tr>
<tr class="separator:a658404899be2339778266056eb36da07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61ceb824381d5a877c5c8182dc6c9040"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#a61ceb824381d5a877c5c8182dc6c9040">refc_binary_get_data</a> (const struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *refc)</td></tr>
<tr class="memdesc:a61ceb824381d5a877c5c8182dc6c9040"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the data of the off-context binary  <a href="refc__binary_8c.html#a61ceb824381d5a877c5c8182dc6c9040">More...</a><br /></td></tr>
<tr class="separator:a61ceb824381d5a877c5c8182dc6c9040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86ee3d766d20e0e12cb10213103f2b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#ae86ee3d766d20e0e12cb10213103f2b3">refc_binary_increment_refcount</a> (struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *refc)</td></tr>
<tr class="memdesc:ae86ee3d766d20e0e12cb10213103f2b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the reference count on the refc binary.  <a href="refc__binary_8c.html#ae86ee3d766d20e0e12cb10213103f2b3">More...</a><br /></td></tr>
<tr class="separator:ae86ee3d766d20e0e12cb10213103f2b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e0f452622b6a9f6b85dfccb73810efe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#a9e0f452622b6a9f6b85dfccb73810efe">refc_binary_decrement_refcount</a> (struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *refc)</td></tr>
<tr class="memdesc:a9e0f452622b6a9f6b85dfccb73810efe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement the reference count on the refc binary.  <a href="refc__binary_8c.html#a9e0f452622b6a9f6b85dfccb73810efe">More...</a><br /></td></tr>
<tr class="separator:a9e0f452622b6a9f6b85dfccb73810efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af777e99bca2b607b342b25d5f2a17a12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="term__typedef_8h.html#a603769ce1e8eeb1faa458d7e6cf904d8">term</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#af777e99bca2b607b342b25d5f2a17a12">refc_binary_create_binary_info</a> (<a class="el" href="struct_context.html">Context</a> *ctx)</td></tr>
<tr class="separator:af777e99bca2b607b342b25d5f2a17a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6d254b27cb8e50fae8a4a44b2c34a1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refc__binary_8c.html#afe6d254b27cb8e50fae8a4a44b2c34a1">refc_binary_total_size</a> (<a class="el" href="struct_context.html">Context</a> *ctx)</td></tr>
<tr class="memdesc:afe6d254b27cb8e50fae8a4a44b2c34a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total size (in bytes) of all reference counted binaries.  <a href="refc__binary_8c.html#afe6d254b27cb8e50fae8a4a44b2c34a1">More...</a><br /></td></tr>
<tr class="separator:afe6d254b27cb8e50fae8a4a44b2c34a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af777e99bca2b607b342b25d5f2a17a12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af777e99bca2b607b342b25d5f2a17a12">&#9670;&nbsp;</a></span>refc_binary_create_binary_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="term__typedef_8h.html#a603769ce1e8eeb1faa458d7e6cf904d8">term</a> refc_binary_create_binary_info </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TODO consider implementing erlang:memory/0,1 instead </p>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00069">69</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
<a id="a658404899be2339778266056eb36da07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a658404899be2339778266056eb36da07">&#9670;&nbsp;</a></span>refc_binary_create_refc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_refc_binary.html">RefcBinary</a>* refc_binary_create_refc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a reference-counted binary outside of the process heap. </p>
<p>This function will create a reference-counted binary outside of the context heap. If the binary is non-const, a blob will be allocated in the VM memory (e.g., via malloc). The allocated data will include an internal data structure that includes the data size and reference count. If the supplied data is non-NULL, the supplied data will be copied to the newly allocated region. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>the size of the data to create </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the out-of-context data. </dd></dl>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00034">34</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
<a id="a9e0f452622b6a9f6b85dfccb73810efe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e0f452622b6a9f6b85dfccb73810efe">&#9670;&nbsp;</a></span>refc_binary_decrement_refcount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool refc_binary_decrement_refcount </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrement the reference count on the refc binary. </p>
<p>This function will free the the refc binary if the reference count reaches 0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>the refc binary </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the refc binary was free'd; false, otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00058">58</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
<a id="a61ceb824381d5a877c5c8182dc6c9040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61ceb824381d5a877c5c8182dc6c9040">&#9670;&nbsp;</a></span>refc_binary_get_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* refc_binary_get_data </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the data of the off-context binary </p>
<p>Return the data of the off-context binary </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Refc binary returned from memory_create_refc_binary </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00048">48</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
<a id="ae86ee3d766d20e0e12cb10213103f2b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae86ee3d766d20e0e12cb10213103f2b3">&#9670;&nbsp;</a></span>refc_binary_increment_refcount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void refc_binary_increment_refcount </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct_refc_binary.html">RefcBinary</a> *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increment the reference count on the refc binary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>the refc binary </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00053">53</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
<a id="afe6d254b27cb8e50fae8a4a44b2c34a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6d254b27cb8e50fae8a4a44b2c34a1">&#9670;&nbsp;</a></span>refc_binary_total_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t refc_binary_total_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the total size (in bytes) of all reference counted binaries. </p>
<dl class="section return"><dt>Returns</dt><dd>the total size (in bytes) of all reference counted binaries </dd></dl>

<p class="definition">Definition at line <a class="el" href="refc__binary_8c_source.html#l00093">93</a> of file <a class="el" href="refc__binary_8c_source.html">refc_binary.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
