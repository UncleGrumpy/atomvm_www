<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started Guide &mdash; AtomVM 0.6.0-dev+git.27e4ee34 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://atomvm.net/doc/getting-started-guide.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Programmers Guide" href="programmers-guide.html" />
    <link rel="prev" title="Release Notes" href="release-notes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/avm_logo_banner.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                master
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="welcome-to-atomvm.html">Welcome to AtomVM!</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-on-the-esp32-platform">Getting Started on the ESP32 platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deployment-overview">Deployment Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connecting-the-esp32-device">Connecting the ESP32 device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-the-atomvm-virtual-machine">Deploying the AtomVM virtual machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#flashing-a-binary-images">Flashing a binary images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-from-source">Building from source</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-an-atomvm-application">Deploying an AtomVM application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#erlang-tooling">Erlang Tooling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elixir-tooling">Elixir Tooling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-on-the-stm32-platform">Getting Started on the STM32 platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-an-atomvm-binary">Build an AtomVM binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flashing">Flashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printing">Printing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distributed-binaries">Distributed Binaries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-on-the-raspberry-pi-pico-platform">Getting Started on the Raspberry Pi Pico platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-atomvm-for-raspberry-pico">Building AtomVM for Raspberry Pico</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-atomvm-and-programs-on-raspberry-pico">Installing AtomVM and programs on Raspberry Pico</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-atomvm-on-raspberry-pico">Installing AtomVM on Raspberry Pico</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-atomvm-library-to-raspberry-pico">Installing atomvm library to Raspberry Pico</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-it">Installing it</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#running-hello-pico">Running Hello Pico</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-your-own-beam-code-on-raspberry-pico">Running your own BEAM code on Raspberry Pico</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-on-the-generic-unix-platform">Getting Started on the Generic UNIX platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#where-to-go-from-here">Where to go from here</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-with-atomvm-webassembly-port">Getting Started with AtomVM WebAssembly port.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Where to go from here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="programmers-guide.html">Programmers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="example-programs.html">Example Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="network-programming-guide.html">Network Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="build-instructions.html">Build Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="atomvm-internals.html">AtomVM Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-management.html">Memory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="packbeam-format.html">Packbeam Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference-documentation.html">API Reference Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AtomVM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started Guide</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!--
 Copyright 2021-2022 Fred Dushin <fred@dushin.net>

 SPDX-License-Identifier: Apache-2.0 OR LGPL-2.1-or-later
-->
<section id="getting-started-guide">
<h1>Getting Started Guide<a class="headerlink" href="#getting-started-guide" title="Permalink to this heading"></a></h1>
<p>The getting started is broken up into the following sections:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#getting-started-on-the-esp32-platform"><span class="xref myst">Getting Started on the ESP32 platform</span></a></p></li>
<li><p><a class="reference internal" href="#getting-started-on-the-stm32-platform"><span class="xref myst">Getting Started on the STM32 platform</span></a></p></li>
<li><p><a class="reference internal" href="#getting-started-on-the-raspberry-pi-pico-platform"><span class="xref myst">Getting Started on the Raspberry Pi Pico platform</span></a></p></li>
<li><p><a class="reference internal" href="#getting-started-on-the-generic-unix-platform"><span class="xref myst">Getting Started on the Generic UNIX platform</span></a></p></li>
</ul>
<section id="getting-started-on-the-esp32-platform">
<h2>Getting Started on the ESP32 platform<a class="headerlink" href="#getting-started-on-the-esp32-platform" title="Permalink to this heading"></a></h2>
<p>The AtomVM virtual machine is supported on the <a class="reference external" href="https://www.espressif.com">Espressif</a> <a class="reference external" href="https://www.espressif.com/en/products/socs/esp32">ESP32</a> platform, allowing users to write Erlang and Elixir programs and deploy them to the ESP32 micro-controller.</p>
<p>These instructions cover how to get the AtomVM virtual machine flashed to your ESP32 device, as well as how to flash your Erlang and Elixir programs that will be executed by the virtual machine running on the device.</p>
<p>For most applications, you should only need to install the VM once (or at least once per desired AtomVM release).  Once the VM is uploaded, you can then begin development of Erlang or Elixir applications, which can then be flashed as part of your routine development cycle.</p>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h3>
<p>Deployment of AtomVM applications requires the following components:</p>
<ul class="simple">
<li><p>A computer running MacOS or Linux (Windows support is not currently supported);</p></li>
<li><p>An ESP32 module with a USB/UART connector (typically part of an ESP32 development board);</p></li>
<li><p>A USB cable capable of connecting the ESP32 module or board to your development machine (laptop or PC);</p></li>
<li><p>The <a class="reference external" href="https://github.com/espressif/esptool"><code class="docutils literal notranslate"><span class="pre">esptool</span></code></a> program, for flashing the AtomVM image and AtomVM programs;</p></li>
<li><p>An <a class="reference external" href="https://erlang.org">Erlang/OTP</a>;</p></li>
<li><p>A serial console program, such as <code class="docutils literal notranslate"><span class="pre">minicom</span></code> or <code class="docutils literal notranslate"><span class="pre">screen</span></code>, so that you can view console output from your AtomVM application.</p></li>
<li><p>(recommended) For Erlang programs, <a class="reference external" href="https://rebar3.org"><code class="docutils literal notranslate"><span class="pre">rebar3</span></code></a>;</p></li>
<li><p>(recommended) For Elixir programs, <a class="reference external" href="https://elixir-lang.org/getting-started/mix-otp/introduction-to-mix.html"><code class="docutils literal notranslate"><span class="pre">mix</span></code></a>, which ships with the Elixir runtime;</p></li>
</ul>
<p>For information about specific versions of required software, see the <a class="reference internal" href="release-notes.html"><span class="std std-doc">Release Notes</span></a>.</p>
</section>
<section id="deployment-overview">
<h3>Deployment Overview<a class="headerlink" href="#deployment-overview" title="Permalink to this heading"></a></h3>
<p>The ES32 AtomVM virtual machine is an IDF application that runs on the ESP32 platform.  As an IDF application, it provides the object code to boot the ESP device and execute the AtomVM virtual machine code, which in turn is responsible for execution of an Erlang/Elixir application.</p>
<p>The AtomVM virtual machine is implemented in C, and the AtomVM binary image contains the binary object code compiled from C source files, as well as the ESP boot loader and partition map, which tells the ESP32 how the flash module is laid out.</p>
<p>AtomVM developers will typically write their applications in Erlang or Elixir.  These source files are compiled into BEAM bytecode, which is then assembled into AtomVM “packbeam” (<code class="docutils literal notranslate"><span class="pre">.avm</span></code>) files.  This packbeam file is flashed onto the ESP32 device, starting at the data partition address <code class="docutils literal notranslate"><span class="pre">0x210000</span></code>.  When AtomVM starts, it will look in this partition for the first occurrence of a BEAM module that exports a <code class="docutils literal notranslate"><span class="pre">start/0</span></code> function.  Once that module is located, execution of the BEAM bytecode will commence at that point.</p>
<p>The following diagram provides a simplified overview of the layout of the AtomVM virtual machine and Erlang/Elixir applications on the ESP32 flash module.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|               |
+---------------+  ----------- 0x1000
| boot loader   |           ^
+---------------+           |
| partition map |           | AtomVM
+---------------+           | binary
|               |           | image
|   AtomVM      |           |
|   Virtual     |           |
|   Machine     |           |
|               |           v
+---------------+  ----------- 0x210000
|               |           ^
|               |           |
|     data      |           | Erlang/Elixir
|   partition   |           | Application
|               |           |
|               |           v
+---------------+  ----------- end
</pre></div>
</div>
<p>Deploying an AtomVM application to an ESP32 device typically involved two steps:</p>
<ol class="arabic simple">
<li><p>Connecting the ESP32 device;</p></li>
<li><p>Deploying the AtomVM virtual machine;</p></li>
<li><p>Deploying an AtomVM application (typically an iterative process)</p></li>
</ol>
<p>These steps are described in more detail below.</p>
</section>
<section id="connecting-the-esp32-device">
<h3>Connecting the ESP32 device<a class="headerlink" href="#connecting-the-esp32-device" title="Permalink to this heading"></a></h3>
<p>Connect the ESP32 to your development machine (e.g., laptop or PC) via a USB cable.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+---------------+
| laptop or PC  |
|               |           +-------+
|               | USB       |       |
|               x-----------x       |
|               |           |       |
|               |           +-------+
+---------------+           ESP32
</pre></div>
</div>
<blockquote>
<div><p>Note. There are a wide variety of ESP32 modules, ranging from home-made breadboard solutions to all-in-one development boards.  For simplicity, we assume a development board that can both be powered by a USB cable and which can be simultaneously flashed using the same cable, e.g., the <a class="reference external" href="https://www.espressif.com/en/products/devkits/esp32-devkitc">Espressif ESP32 DevKit</a>.</p>
</div></blockquote>
<p>Consult your local development board documentation for instructions about how to connect your device to your development machine.</p>
</section>
<section id="deploying-the-atomvm-virtual-machine">
<h3>Deploying the AtomVM virtual machine<a class="headerlink" href="#deploying-the-atomvm-virtual-machine" title="Permalink to this heading"></a></h3>
<p>The following methods can be used to deploy the AtomVM virtual machine to an ESP32 device:</p>
<ol class="arabic simple">
<li><p>Flashing a binary image;</p></li>
<li><p>Building from source.</p></li>
</ol>
<section id="flashing-a-binary-images">
<h4>Flashing a binary images<a class="headerlink" href="#flashing-a-binary-images" title="Permalink to this heading"></a></h4>
<p>Flashing the ESP32 using a pre-built binary image is by far the easiest path to getting started with development on the ESP32.  Binary images contain the virtual machine image and all of the necessary components to run your application.</p>
<p>We recommend first erasing any existing applications on the ESP32 device.  E.g.,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>shell$ esptool.py --chip esp32 --port /dev/ttyUSB0 --baud 115200 erase_flash
...
</pre></div>
</div>
<blockquote>
<div><p>Note.  Specify the device port and baud settings and AtomVM image name to suit your particular environment.</p>
</div></blockquote>
<p>Next, download a stable or latest development ESP32 <a class="reference external" href="https://github.com/atomvm/AtomVM/releases">release image</a>.</p>
<blockquote>
<div><p>Note.  Development images may be unstable and may result in unpredictable behavior.</p>
</div></blockquote>
<p>Finally, use the <code class="docutils literal notranslate"><span class="pre">esptool</span></code> to flash the image to the start address <code class="docutils literal notranslate"><span class="pre">0x1000</span></code> on the ESP32.  E.g.,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>shell$ esptool.py --chip esp32 --port /dev/ttyUSB0 --baud 115200 \
    --before default_reset --after hard_reset \
    write_flash -u --flash_mode dio --flash_freq 40m --flash_size detect \
    0x1000 atomvm-esp32-v0.1.0.bin
...
</pre></div>
</div>
<p>Once completed, your ESP32 device is ready to run Erlang or Elixir programs targeted for AtomVM.</p>
</section>
<section id="building-from-source">
<h4>Building from source<a class="headerlink" href="#building-from-source" title="Permalink to this heading"></a></h4>
<p>You may optionally build AtomVM from source and deploy the AtomVM virtual machine to your ESP32 device manually.  Building AtomVM from source is slightly more involved, as it requires the installation of the Espressif IDF SDK and tool chain and is typically recommended only for users who are doing development on the AtomVM virtual machine, or for developers implementing custom Nifs or ports.</p>
<p>Instructions for building AtomVM from source are covered in the AtomVM <a class="reference internal" href="build-instructions.html"><span class="std std-doc">Build Instructions</span></a></p>
</section>
</section>
<section id="deploying-an-atomvm-application">
<h3>Deploying an AtomVM application<a class="headerlink" href="#deploying-an-atomvm-application" title="Permalink to this heading"></a></h3>
<p>An AtomVM application is a collection of BEAM files, which have been compiled using the Erlang or Elixir compiler.  These BEAM files are assembled into an AtomVM “packbeam” (<code class="docutils literal notranslate"><span class="pre">.avm</span></code>) file, which in turn is flashed to the <code class="docutils literal notranslate"><span class="pre">main</span></code> data partition on the ESP32 flash module, starting at address <code class="docutils literal notranslate"><span class="pre">0x210000</span></code>.</p>
<p>When the AtomVM virtual machine starts, it will search for the first module that contains an exported <code class="docutils literal notranslate"><span class="pre">start/0</span></code> function in this partition, and it will begin execution of the BEAM bytecode at that function.</p>
<p>AtomVM applications can be written in Erlang or Elixir, or a combination of both.  The AtomVM community has provided tooling for both platforms, making deployment of AtomVM applications as seamless as possible.</p>
<p>This section describes both Erlang and Elixir tooling for deploying AtomVM applications to ESP32 devices.</p>
<section id="erlang-tooling">
<h4>Erlang Tooling<a class="headerlink" href="#erlang-tooling" title="Permalink to this heading"></a></h4>
<p>Deployment of AtomVM applications written in the Erlang programming language is supported via the <a class="reference external" href="https://github.com/atomvm/atomvm_rebar3_plugin"><code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code></a> plugin, a community-supported plugin to the <a class="reference external" href="https://rebar3.org"><code class="docutils literal notranslate"><span class="pre">rebar3</span></code></a> Erlang build tool.</p>
<p>You can generate a simple application from scratch using the <code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code> template, as follows:</p>
<p>Edit or create the <code class="docutils literal notranslate"><span class="pre">$HOME/.config/rebar3/rebar.config</span></code> file to include the <code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code> plugin:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%% $HOME/.config/rebar3/rebar.config
{plugins, [
    atomvm_rebar3_plugin,
    ...
]}.
</pre></div>
</div>
<p>In any directory in which you have write permission, issue</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>shell$ rebar3 new atomvm_app &lt;app-name&gt;
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;app-name&gt;</span></code> is the name of the application you would like to create (e.g., <code class="docutils literal notranslate"><span class="pre">myapp</span></code>).  This command will generate a rebar project under the directory <code class="docutils literal notranslate"><span class="pre">&lt;app-name&gt;</span></code>.</p>
<p>The generated application will contain the proper <code class="docutils literal notranslate"><span class="pre">rebar.config</span></code> configuration and will contain the <code class="docutils literal notranslate"><span class="pre">&lt;app-name&gt;.erl</span></code> module, which exports the <code class="docutils literal notranslate"><span class="pre">start/0</span></code> function with a stubbed implementation.</p>
<p>Specifically, note the following stanza in the generated <code class="docutils literal notranslate"><span class="pre">rebar.config</span></code> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%% rebar.config
{plugins, [
    atomvm_rebar3_plugin,
    ...
]}.
</pre></div>
</div>
<p>And note the <code class="docutils literal notranslate"><span class="pre">myapp</span></code> application exports a <code class="docutils literal notranslate"><span class="pre">start/0</span></code> function, e.g.,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%% erlang
-module(myapp).
-export([start/0]).

start() -&gt;
    ok.
</pre></div>
</div>
<p>With this plugin installed, you have access to the <code class="docutils literal notranslate"><span class="pre">esp32_flash</span></code> target, which will build an AtomVM packbeam</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>shell$ rebar3 esp32_flash --port /dev/ttyUSB0
===&gt; Fetching atomvm_rebar3_plugin v0.6.0
===&gt; Fetching rebar3_hex v6.11.3
===&gt; Fetching hex_core v0.7.1
===&gt; Fetching verl v1.0.2
===&gt; Analyzing applications...
===&gt; Compiling verl
===&gt; Compiling hex_core
===&gt; Compiling rebar3_hex
===&gt; Fetching atomvm_packbeam v0.6.0
===&gt; Analyzing applications...
===&gt; Compiling atomvm_rebar3_plugin
===&gt; Compiling packbeam
===&gt; Verifying dependencies...
===&gt; Analyzing applications...
===&gt; Compiling myapp
===&gt; AVM file written to : myapp.avm
===&gt; esptool.py --chip esp32 --port /dev/ttyUSB0 --baud 115200 --before default_reset --after hard_reset write_flash -u --flash_mode dio --flash_freq 40m --flash_size detect 0x210000 /home/frege/myapp/_build/default/lib/myapp.avm
</pre></div>
</div>
<blockquote>
<div><p>Note. Consult the the <a class="reference external" href="https://github.com/atomvm/atomvm_rebar3_plugin"><code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code></a> plugin documentation, for more detailed information about how to use this tool.</p>
</div></blockquote>
<p>Once the application has been flashed, you may connect to the ESP32 over the serial port using <code class="docutils literal notranslate"><span class="pre">minicom</span></code>, <code class="docutils literal notranslate"><span class="pre">screen</span></code>, or equivalent.</p>
</section>
<section id="elixir-tooling">
<h4>Elixir Tooling<a class="headerlink" href="#elixir-tooling" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>TODO mix + https://github.com/atomvm/ExAtomVM + hex</p>
</div></blockquote>
</section>
</section>
</section>
<section id="getting-started-on-the-stm32-platform">
<h2>Getting Started on the STM32 platform<a class="headerlink" href="#getting-started-on-the-stm32-platform" title="Permalink to this heading"></a></h2>
<p>AtomVM can run on a wide variety of STM32 chipsets available from <a class="reference external" href="https://www.st.com">STMicroelectronics</a>. The support is not nearly as mature as for the ESP32 platform, but work is ongoing, and pull requests are always welcome. At this time AtomVM will work on any board with a minimum of around 128k ram and 512k (1M recommended) flash. Simple applications and tests have been successfully run on a stm32f411ceu6 (A.K.A. Black Pill V2). These minimum requirements may need to be raised as platform support matures.</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/texane/stlink">st-flash</a>, to flash both AtomVM and your packed AVM applications. Make sure to follow its <a class="reference external" href="https://github.com/texane/stlink#installation">installation procedure</a> before proceeding further.</p></li>
<li><p><a class="reference external" href="https://github.com/atomvm/atomvm_packbeam"><code class="docutils literal notranslate"><span class="pre">packbeam</span></code></a> the AtomVM for packing and stripping <code class="docutils literal notranslate"><span class="pre">*.beam</span></code> files into the AtomVM <code class="docutils literal notranslate"><span class="pre">*.avm</span></code> format.</p></li>
<li><p>A serial console program, such as <code class="docutils literal notranslate"><span class="pre">minicom</span></code> or <code class="docutils literal notranslate"><span class="pre">screen</span></code>, so that you can view console output from your AtomVM application.</p></li>
</ul>
</section>
<section id="build-an-atomvm-binary">
<h3>Build an AtomVM binary<a class="headerlink" href="#build-an-atomvm-binary" title="Permalink to this heading"></a></h3>
<p>You will first need to build a binary configured for your processor and board layout. Consult the <a class="reference internal" href="#./build-instructions#building-for-stm32"><span class="xref myst">Build Instruction for STM32</span></a></p>
</section>
<section id="flashing">
<h3>Flashing<a class="headerlink" href="#flashing" title="Permalink to this heading"></a></h3>
<p>To flash AtomVM, use</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ st-flash --reset write AtomVM-stm32f407vgt6.bin 0x8000000
</pre></div>
</div>
<p>To flash your packed AVM, use</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ st-flash --reset write /path/to/your/packed.avm 0x8080000
</pre></div>
</div>
<p>You must include the atomvmlib.avm with your application when using <a class="reference external" href="https://github.com/atomvm/atomvm_packbeam">packbeam</a>, and it should be pruned:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ packbeam create -p -i application.avm application.beam /path/to/AtomVM/build/libs/atomvmlib.avm
</pre></div>
</div>
<blockquote>
<div><p>Note: The option<code class="docutils literal notranslate"><span class="pre">-i</span></code> will instruct packbeam to include file names and line numbers in stack traces. This makes debugging applications far easier, but also increases size, so it may be omitted if desired. The <code class="docutils literal notranslate"><span class="pre">-p</span></code> option should be used, it instructs packbeam to prune the unused functions from the packed <code class="docutils literal notranslate"><span class="pre">.avm</span></code> file, and is strongly recommended.</p>
</div></blockquote>
<p>AtomVM expects to find the AVM at the address 0x808000. On a STM32 Discovery board this means that the 1MB of flash will be split in 512KB available for the program and 512KB available for the packed AVM. If for any reason you want to modify this, you can change <code class="docutils literal notranslate"><span class="pre">AVM_ADDRESS</span></code> and <code class="docutils literal notranslate"><span class="pre">AVM_FLASH_MAX_SIZE</span></code> defines in <code class="docutils literal notranslate"><span class="pre">main.c</span></code>.</p>
</section>
<section id="printing">
<h3>Printing<a class="headerlink" href="#printing" title="Permalink to this heading"></a></h3>
<p>By default, stdout and stderr are printed on USART2. On the STM32F4Discovery board, you can see them
using a TTL-USB with the TX pin connected to board’s pin PA2 (USART2 RX). Baudrate is 115200 and serial transmission
is 8N1 with no flow control.</p>
</section>
<section id="distributed-binaries">
<h3>Distributed Binaries<a class="headerlink" href="#distributed-binaries" title="Permalink to this heading"></a></h3>
<p>Due to the very large number of supported chipsets, the wide variety of board configurations, and the code changes required to support them, it is unlikely pre-built binaries will be available for the stm32 platform in the near future. Consult the <a class="reference internal" href="#./build-instructions#building-for-stm32"><span class="xref myst">Build Instruction</span></a> to create a binary compatible with your board.</p>
</section>
</section>
<section id="getting-started-on-the-raspberry-pi-pico-platform">
<h2>Getting Started on the Raspberry Pi Pico platform<a class="headerlink" href="#getting-started-on-the-raspberry-pi-pico-platform" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>Prerequisites<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>None of these tools are strictly required, but all are recommended for easier development:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://rebar3.org"><code class="docutils literal notranslate"><span class="pre">rebar3</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/atomvm/atomvm_rebar3_plugin"><code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/atomvm/atomvm_packbeam"><code class="docutils literal notranslate"><span class="pre">packbeam</span></code></a> the AtomVM for packing and stripping <code class="docutils literal notranslate"><span class="pre">*.beam</span></code> files into the AtomVM <code class="docutils literal notranslate"><span class="pre">*.avm</span></code> format. (included as part of the <code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code>)</p></li>
<li><p>A serial console program, such as <code class="docutils literal notranslate"><span class="pre">minicom</span></code> or <code class="docutils literal notranslate"><span class="pre">screen</span></code>, so that you can view console output from your AtomVM application.</p></li>
</ul>
</section>
<section id="building-atomvm-for-raspberry-pico">
<h3>Building AtomVM for Raspberry Pico<a class="headerlink" href="#building-atomvm-for-raspberry-pico" title="Permalink to this heading"></a></h3>
<p>If you want to use a custom built VM for testing consult the <a class="reference internal" href="#./build-instructions#building-for-raspberry-pi-pico"><span class="xref myst">Build Instructions for Raspberry Pi Pico</span></a></p>
</section>
<section id="installing-atomvm-and-programs-on-raspberry-pico">
<h3>Installing AtomVM and programs on Raspberry Pico<a class="headerlink" href="#installing-atomvm-and-programs-on-raspberry-pico" title="Permalink to this heading"></a></h3>
<p>The approach consists in installing various uf2 files which include the
address they should be loaded to.</p>
<p>You typically need three uf2 files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AtomVM.uf2</span></code> for the VM</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atomvmlib.uf2</span></code> for the standard libraries</p></li>
<li><p>your application’s uf2.</p></li>
</ul>
<p>We provide an escript-based (what else?) tool to build uf2 files called
<code class="docutils literal notranslate"><span class="pre">uf2tool</span></code> that you can use to bundle your <code class="docutils literal notranslate"><span class="pre">avm</span></code> into uf2.</p>
<p>If you need to upgrade AtomVM or the standard libraries, simply copy them again.</p>
</section>
<section id="installing-atomvm-on-raspberry-pico">
<h3>Installing AtomVM on Raspberry Pico<a class="headerlink" href="#installing-atomvm-on-raspberry-pico" title="Permalink to this heading"></a></h3>
<p>VM binary is file <code class="docutils literal notranslate"><span class="pre">AtomVM.uf2</span></code> - <code class="docutils literal notranslate"><span class="pre">src/platforms/rp2040/build/src/AtomVM.uf2</span></code> if build from source. Simply copy it
to the pico. The VM will crash because there is no application.</p>
</section>
<section id="installing-atomvm-library-to-raspberry-pico">
<h3>Installing atomvm library to Raspberry Pico<a class="headerlink" href="#installing-atomvm-library-to-raspberry-pico" title="Permalink to this heading"></a></h3>
<p>AtomVM library must be installed as well. For Build instructions consult the Raspberry Pi Pico <a class="reference internal" href="#./build-instructions#libatomvm-build-steps"><span class="xref myst">libAtomVM build steps</span></a></p>
<section id="installing-it">
<h4>Installing it<a class="headerlink" href="#installing-it" title="Permalink to this heading"></a></h4>
<p>The library to install is <code class="docutils literal notranslate"><span class="pre">atomvmlib.uf2</span></code>, <code class="docutils literal notranslate"><span class="pre">build/libs/atomvmlib.uf2</span></code> if build from source. Copy the library to the pico.</p>
</section>
</section>
<section id="running-hello-pico">
<h3>Running Hello Pico<a class="headerlink" href="#running-hello-pico" title="Permalink to this heading"></a></h3>
<p>This example will print a Hello Pico message repeatedly.</p>
<p>It is built into <code class="docutils literal notranslate"><span class="pre">build/examples/erlang/rp2040/hello_pico.uf2</span></code>.</p>
<p>You can install it and then connect to the serial port with minicom.</p>
</section>
<section id="running-your-own-beam-code-on-raspberry-pico">
<h3>Running your own BEAM code on Raspberry Pico<a class="headerlink" href="#running-your-own-beam-code-on-raspberry-pico" title="Permalink to this heading"></a></h3>
<p>You need to create an avm file using the <code class="docutils literal notranslate"><span class="pre">packbeam</span></code> tool the <a class="reference external" href="https://github.com/atomvm/atomvm_rebar3_plugin"><code class="docutils literal notranslate"><span class="pre">atomvm_rebar3_plugin</span></code></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>packbeam create -p -i packed.avm module.beam
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rebar3 packbeam -p -i packed.avm module.beam
</pre></div>
</div>
<p>Then the BEAM file must be converted to UF2.
The VM currently expects the application to be loaded at address 0x100A0000.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./uf2tool create -o packed.uf2 -s 0x100A0000 packed.avm
</pre></div>
</div>
<p>Copy this UF2 to the Pico after you copied the VM (<code class="docutils literal notranslate"><span class="pre">AtomVM.uf2</span></code>) and the
standard libraries (<code class="docutils literal notranslate"><span class="pre">atomvmlib.uf2</span></code>).</p>
</section>
</section>
<section id="getting-started-on-the-generic-unix-platform">
<h2>Getting Started on the Generic UNIX platform<a class="headerlink" href="#getting-started-on-the-generic-unix-platform" title="Permalink to this heading"></a></h2>
<p>AtomVM may be run on UNIX-like platforms using the <code class="docutils literal notranslate"><span class="pre">atomvm</span></code> command.</p>
<p>You may specify one or more AVM files on the command line when running the <code class="docutils literal notranslate"><span class="pre">atom</span></code> command.  BEAM modules defined in earlier AVM modules on the command line take higher precedence that BEAM modules included in AVM files later in the argument list.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>shell$ atomvm /path/to/myapp.avm
</pre></div>
</div>
<p>Currently, the <code class="docutils literal notranslate"><span class="pre">atomvm</span></code> command and libraries must be built and installed from source.</p>
<blockquote>
<div><p>See the AtomVM <a class="reference internal" href="build-instructions.html"><span class="std std-doc">Build Instructions</span></a> for instructions about how to build AtomVM on the Generic UNIX platform.</p>
</div></blockquote>
</section>
<section id="where-to-go-from-here">
<h2>Where to go from here<a class="headerlink" href="#where-to-go-from-here" title="Permalink to this heading"></a></h2>
<p>The following resources may be useful for understanding how to develop Erlang or Elixir applications for the AtomVM platform:</p>
<ul class="simple">
<li><p><a class="reference internal" href="example-programs.html"><span class="std std-doc">Example Programs</span></a></p></li>
<li><p><a class="reference internal" href="programmers-guide.html"><span class="std std-doc">Programmers Guide</span></a></p></li>
</ul>
</section>
<section id="getting-started-with-atomvm-webassembly-port">
<h2>Getting Started with AtomVM WebAssembly port.<a class="headerlink" href="#getting-started-with-atomvm-webassembly-port" title="Permalink to this heading"></a></h2>
<p>AtomVM may be run on platforms with NodeJS from the AtomVM.js file (with its companion AtomVM.wasm file).</p>
<p>Currently, these files must be built and installed from source.</p>
<blockquote>
<div><p>See the AtomVM <a class="reference internal" href="build-instructions.html"><span class="std std-doc">Build Instructions</span></a> for instructions about how to build AtomVM WebAssembly port.</p>
</div></blockquote>
<p>AtomVM may also be run in modern browsers (Safari, Chrome and Chrome-based, Firefox) from the AtomVM.js, AtomVM.worker.js and AtomVM.wasm files.</p>
<p>Currently, these files must be built and installed from source. They also need to be installed on a web server that send <code class="docutils literal notranslate"><span class="pre">Cross-Origin-Opener-Policy</span></code> and <code class="docutils literal notranslate"><span class="pre">Cross-Origin-Embedder-Policy</span></code> headers as explained in <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements">Mozilla’s documentation</a>.</p>
<p>AtomVM comes with a toy web server you can use and run with AtomVM built for Generic Unix with:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">AtomVM</span><span class="w"> </span><span class="n">examples</span><span class="o">/</span><span class="n">emscripten</span><span class="o">/</span><span class="n">wasm_webserver</span><span class="p">.</span><span class="n">avm</span>
</pre></div>
</div>
<p>This web server serves HTML files from <code class="docutils literal notranslate"><span class="pre">examples/emscripten/</span></code> which you can copy to a webserver along with binaries and built files.</p>
</section>
<section id="id2">
<h2>Where to go from here<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h2>
<p>The following resources may be useful for understanding how to develop Erlang or Elixir applications for the AtomVM platform:</p>
<ul class="simple">
<li><p><a class="reference internal" href="example-programs.html"><span class="std std-doc">Example Programs</span></a></p></li>
<li><p><a class="reference internal" href="programmers-guide.html"><span class="std std-doc">Programmers Guide</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="release-notes.html" class="btn btn-neutral float-left" title="Release Notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="programmers-guide.html" class="btn btn-neutral float-right" title="Programmers Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2023, AtomVM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!--
 Copyright 2023 Winford (Uncle Grumpy) <winford@object.stream>

 SPDX-License-Identifier: Apache-2.0 OR LGPL-2.1-or-later

 Based on the work of  Michael Altfield:
 https://tech.michaelaltfield.net/2020/07/18/sphinx-rtd-github-pages-1
-->



  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book">AtomVM Docs</span>
      v: master
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Versions</dt>
        
           <strong> 
          <dd><a href="/doc/master/">master</a></dd>
           </strong> 
        
          
          <dd><a href="/doc/release-0.5/">release-0.5</a></dd>
          
        
      </dl>
      
      
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/doc/master/pdf/AtomVM-master.pdf">pdf</a></dd>
        
          <dd><a href="/doc/master/epub/AtomVM-master.epub">epub</a></dd>
        
      </dl>
      
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>